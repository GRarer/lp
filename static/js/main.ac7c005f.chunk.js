(this.webpackJsonplp=this.webpackJsonplp||[]).push([[0],{101:function(e,t,n){},113:function(e,t){},114:function(e,t){},115:function(e,t,n){},116:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(12),i=n.n(s),o=(n(101),n(16)),c=n(17),l=n(19),u=n(18),h=n(177),d=n(186),j=n(183),b=n(47),f=n(163),p=n(166),O=n(170),m=n(171),v=n(165),x=n(187),g=n(172),S=n(173),w=n(82),y=n.n(w),k=n(81),I=n.n(k),C=n(188),U=n(169),M=n(182),E=n(11),L=["album","attachment","book","label","note"],F=L.reduce((function(e,t){return E.a.union(e,E.a.literal(t))}),E.a.literal(L[0])),D=E.a.recordOf({listIcon:F,ImageDataUrl:E.a.optional(E.a.aString)}),T=n(155),H=n(159),_=n(160),N=n(161),R=n(162),P=n(2);function A(e){switch(e.icon){case"album":return Object(P.jsx)(T.a,{});case"attachment":return Object(P.jsx)(H.a,{});case"book":return Object(P.jsx)(_.a,{});case"label":return Object(P.jsx)(N.a,{});case"note":return Object(P.jsx)(R.a,{})}}var B=n(185),W=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).fileInput=void 0,a.fileInput=r.a.createRef(),a.state={uniqueInputId:"file-input-".concat(Object(B.a)()),errorSnackbarMessage:void 0},a}return Object(c.a)(n,[{key:"handleSubmit",value:function(){var e,t=this.fileInput.current;if(null!==t){var n=null===(e=t.files)||void 0===e?void 0:e[0];n?(t.value="",this.props.onUpload(n)):this.setState({errorSnackbarMessage:"File not found!"})}}},{key:"dismissError",value:function(){this.setState({errorSnackbarMessage:void 0})}},{key:"render",value:function(){var e=this;return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("input",{accept:this.props.accept,style:{display:"none"},id:this.state.uniqueInputId,type:"file",ref:this.fileInput,onInput:function(){e.handleSubmit()}}),Object(P.jsx)("label",{htmlFor:this.state.uniqueInputId,children:Object(P.jsx)(f.a,{style:{width:"100%"},variant:"contained",component:"span",children:this.props.text})}),Object(P.jsx)(d.a,{open:!!this.state.errorSnackbarMessage,autoHideDuration:6e3,onClose:function(){e.dismissError()},children:Object(P.jsx)(j.a,{elevation:6,variant:"filled",onClose:function(){e.dismissError()},severity:"error",children:this.state.errorSnackbarMessage})})]})}}]),n}(r.a.Component),q=n(66),Y=n.n(q),z=n(80),J="customization_settings";function X(){return(X=Object(z.a)(Y.a.mark((function e(t){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=new FileReader;a.addEventListener("load",(function(){var t=a.result;"string"===typeof t?e(t):n(new Error("file reader did not have expected result type"))})),a.addEventListener("error",(function(){var e;n(null!==(e=a.error)&&void 0!==e?e:new Error("unknown file reader error"))})),a.readAsDataURL(t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var G=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state=e.prevSettings,a}return Object(c.a)(n,[{key:"changeListIcon",value:function(e){this.setState({listIcon:e})}},{key:"handleImageUpload",value:function(e){var t=this;(function(e){return X.apply(this,arguments)})(e).then((function(e){t.setState({imageDataUrl:e})})).catch((function(e){console.error(e),t.props.changeMenuError("Error: could not read file")}))}},{key:"removeImage",value:function(){this.setState({imageDataUrl:void 0})}},{key:"render",value:function(){var e=this;return Object(P.jsxs)("div",{children:[Object(P.jsx)("div",{style:{marginBottom:"5px"},children:this.state.imageDataUrl?Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(b.a,{variant:"h6",children:"Custom Image"}),Object(P.jsx)("img",{src:this.state.imageDataUrl,style:{maxWidth:"2in",maxHeight:"2in"}}),Object(P.jsx)(f.a,{color:"secondary",onClick:this.removeImage.bind(this),style:{display:"block"},children:"Remove Custom Image"})]}):Object(P.jsx)(W,{onUpload:this.handleImageUpload.bind(this),text:"Upload Label Image",accept:"image/*"})}),Object(P.jsxs)(p.a,{variant:"filled",style:{width:"100%"},children:[Object(P.jsx)(C.a,{id:"icon-select-label",children:"List Icon"}),Object(P.jsx)(M.a,{labelId:"icon-select-label",value:this.state.listIcon,onChange:function(t){e.changeListIcon(t.target.value)},children:L.map((function(e){return Object(P.jsx)(U.a,{value:e,children:Object(P.jsx)(A,{icon:e})},e)}))})]}),Object(P.jsx)("div",{style:{marginTop:"10px"},children:Object(P.jsx)(f.a,{variant:"contained",color:"primary",style:{width:"100%"},onClick:function(){e.props.onSave(e.state)},children:"Save and Close"})})]})}}]),n}(r.a.Component),K=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={showSettings:!1,showHelp:!1,errorSnackbarMessage:void 0},a}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(O.a,{position:"static",children:Object(P.jsxs)(m.a,{children:[Object(P.jsx)(b.a,{variant:"h6",style:{flexGrow:1},children:"LP Label Printer"}),Object(P.jsx)(v.a,{edge:"end","aria-label":"help",color:"inherit",onClick:function(){e.setState({showHelp:!0})},children:Object(P.jsx)(I.a,{})}),Object(P.jsx)(v.a,{edge:"end","aria-label":"settings",color:"inherit",onClick:function(){e.setState({showSettings:!0})},children:Object(P.jsx)(y.a,{})})]})}),Object(P.jsxs)(x.a,{open:this.state.showSettings,children:[Object(P.jsx)(g.a,{children:"Settings"}),Object(P.jsx)(S.a,{children:Object(P.jsx)(G,{prevSettings:this.props.settings,onSave:function(t){e.setState({showSettings:!1}),e.props.onSaveSettings(t)},changeMenuError:function(t){e.setState({errorSnackbarMessage:t})}})})]}),Object(P.jsxs)(x.a,{open:this.state.showHelp,maxWidth:"lg",children:[Object(P.jsx)(g.a,{children:"About"}),Object(P.jsxs)(S.a,{style:{width:"6in"},children:[Object(P.jsx)(b.a,{variant:"h6",children:"How To Use"}),Object(P.jsxs)("ol",{children:[Object(P.jsx)("li",{children:"Record your items as an Excel spreadsheet (.XLSX file)."}),Object(P.jsx)("li",{children:"Upload your spreadsheet."}),Object(P.jsx)("li",{children:"Select one or more items that you want to print labels for. Each label will open in a new tab."}),Object(P.jsx)("li",{children:"Print the label from your web browser."})]}),Object(P.jsx)(b.a,{variant:"h6",children:"How To Format Your Spreadsheet"}),Object(P.jsxs)("ul",{children:[Object(P.jsx)("li",{children:"If your file has multiple sheets, the data you want to print should be in the first sheet."}),Object(P.jsx)("li",{children:"The first row of your sheet should be the header row. This contains the names of the attributes stored in each column. Every other row should represent one item in your list."}),Object(P.jsx)("li",{children:"The first two columns are what will be shown in the list when you select which items to print. You may want these first two columns to be the title and subtitle, album name and artist name, etc."}),Object(P.jsxs)("li",{children:["You can control how a column&aposs data will be displayed by adding keywords in brackets to the header of that column.",Object(P.jsxs)("ul",{children:[Object(P.jsxs)("li",{children:[Object(P.jsx)("code",{children:"[label:skip]"})," - this column will not be shown on the labels."]}),Object(P.jsxs)("li",{children:[Object(P.jsx)("code",{children:"[label:5_stars]"}),' - this column will be shown as a score out of 5 stars. The values in this column should be numbers from 0 to 5 in increments of 0.5 (e.g. "0", "2.5", and "5" are all valid values).']}),Object(P.jsxs)("li",{children:[Object(P.jsx)("code",{children:"[label:10_stars]"})," - this column will be shown as a score out of 10 stars."]})]}),'For example, if column D stores "id number" values that you do not want to show on the labels, cell D1 should be set to: ',Object(P.jsx)("code",{children:"id number [label:skip]"})]})]}),Object(P.jsx)(f.a,{variant:"contained",onClick:function(){e.setState({showHelp:!1})},children:"Close"})]})]}),Object(P.jsx)(d.a,{open:!!this.state.errorSnackbarMessage,autoHideDuration:6e3,onClose:function(){e.setState({errorSnackbarMessage:void 0})},children:Object(P.jsx)(j.a,{elevation:6,variant:"filled",onClose:function(){e.setState({errorSnackbarMessage:void 0})},severity:"error",children:this.state.errorSnackbarMessage})})]})}}]),n}(r.a.Component),Q=n(118),V=n(174),Z=n(175),$=n(176),ee=n(168),te=n(83),ne=n.n(te),ae=n(167),re=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={search:""},a}return Object(c.a)(n,[{key:"itemMatchesSearch",value:function(e){var t=this.state.search.toLowerCase();return""===t||e.attributes.some((function(e){return e.value.toLowerCase().includes(t)}))}},{key:"render",value:function(){var e=this,t=this.props.items.filter((function(t){return e.itemMatchesSearch(t)})).map((function(t){return Object(P.jsxs)(Q.a,{button:!0,divider:!0,dense:!0,onClick:function(){e.props.onSelect(t)},children:[Object(P.jsx)(V.a,{children:Object(P.jsx)(A,{icon:e.props.listIcon})}),Object(P.jsx)(Z.a,{primary:t.title,secondary:t.subtitle})]},t.uuid)}));return Object(P.jsxs)("div",{children:[Object(P.jsx)(b.a,{variant:"h5",style:{marginBottom:"5px"},children:"Select a label to print"}),Object(P.jsxs)(p.a,{fullWidth:!0,variant:"filled",children:[Object(P.jsx)(C.a,{htmlFor:"search-control",children:"Search"}),Object(P.jsx)(ae.a,{id:"search-control",value:this.state.search,onChange:function(t){e.setState({search:t.target.value})},endAdornment:Object(P.jsx)($.a,{position:"end",children:Object(P.jsx)(v.a,{onClick:function(){e.setState({search:""})},children:Object(P.jsx)(ne.a,{})})})})]}),Object(P.jsx)(ee.a,{children:t})]})}}]),n}(r.a.Component),se=n(84),ie=E.a.union(E.a.literal("text"),E.a.union(E.a.literal("scoreOutOf5"),E.a.literal("scoreOutOf10"))),oe=E.a.recordOf({name:E.a.aString,value:E.a.aString,format:ie,uuid:E.a.aString}),ce=E.a.recordOf({title:E.a.aString,subtitle:E.a.optional(E.a.aString),attributes:E.a.arrayOf(oe),uuid:E.a.aString}),le="item";function ue(e){var t=e.uuid;window.sessionStorage.setItem(t,Object(E.c)(e,ce));var n=new URL(window.location.href);n.search=new URLSearchParams(Object(se.a)({},le,t)).toString(),window.open(n.toString(),"_blank")}var he=n(60),de=n.n(he),je="[label:skip]",be="[label:5_stars]",fe="[label:10_stars]";function pe(e){var t="text";e.includes(be)&&(t="scoreOutOf5"),e.includes(fe)&&(t="scoreOutOf10"),e.includes(je)&&(t="skip");for(var n=e,a=0,r=[je,be,fe];a<r.length;a++){var s=r[a];n=n.replace(s,"")}return{displayName:n=n.trim(),format:t}}function Oe(e){var t=de.a.read(e,{type:"array"}),n=t.Sheets[t.SheetNames[0]],a=de.a.utils.sheet_to_json(n,{raw:!1,blankrows:!1}),r=de.a.utils.sheet_to_json(n,{header:1})[0];if(!Array.isArray(r)||!r.every((function(e){return"string"===typeof e})))throw"Error: Unexpected parse result";var s=r[0],i=r[1];if("undefined"===typeof s)throw"Error: Spreadsheet is missing first column";var o=new Map(r.map((function(e){return[e,pe(e)]})));return a.map((function(e){return function(e,t,n,a){var r,s=[];for(var i in e){var o,c=t.get(i),l=null===(o=e[i])||void 0===o?void 0:o.trim();l&&c&&"skip"!==c.format&&s.push({uuid:Object(B.a)(),value:l,name:c.displayName,format:c.format})}return{title:null!==(r=e[n])&&void 0!==r?r:"(unknown)",subtitle:a?e[a]:void 0,uuid:Object(B.a)(),attributes:s}}(e,o,s,i)}))}var me=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={settings:e.defaultSettings,items:void 0,errorSnackbarMessage:void 0},a}return Object(c.a)(n,[{key:"updateSettings",value:function(e){this.setState({settings:e}),function(e){window.localStorage.setItem(J,Object(E.c)(e,D))}(e)}},{key:"handleUpload",value:function(e){var t=this;e.arrayBuffer().then((function(e){t.setState({items:Oe(e)})})).catch((function(e){console.error(e);var n="string"===typeof e?e:"Error: Unable to process file";t.setState({errorSnackbarMessage:n})}))}},{key:"dismissError",value:function(){this.setState({errorSnackbarMessage:void 0})}},{key:"render",value:function(){var e=this,t=this.state.items,n=t?Object(P.jsx)(re,{items:t,onSelect:ue,listIcon:this.state.settings.listIcon}):Object(P.jsx)(W,{onUpload:this.handleUpload.bind(this),accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",text:"Upload Spreadsheet"});return Object(P.jsxs)("div",{children:[Object(P.jsx)(K,{settings:this.state.settings,onSaveSettings:this.updateSettings.bind(this)}),Object(P.jsx)(h.a,{maxWidth:"sm",children:Object(P.jsx)("div",{style:{marginTop:"10px"},children:n})}),Object(P.jsx)(d.a,{open:!!this.state.errorSnackbarMessage,autoHideDuration:6e3,onClose:function(){e.dismissError()},children:Object(P.jsx)(j.a,{elevation:6,variant:"filled",onClose:function(){e.dismissError()},severity:"error",children:this.state.errorSnackbarMessage})})]})}}]),n}(r.a.Component);var ve=n(180),xe=n(181),ge=n(179),Se=n(178),we=(n(115),n(85)),ye=n.n(we),ke=n(86),Ie=n.n(ke),Ce=n(87),Ue=n.n(Ce);function Me(e,t){var n=Number.parseFloat(e);if(Number.isNaN(n)||!Number.isInteger(2*n)||n<0||n>t)return Object(P.jsx)(P.Fragment,{children:e});for(var a=[];n>=1;)a.push(Object(P.jsx)(ye.a,{})),n-=1;for(.5===n&&a.push(Object(P.jsx)(Ie.a,{}));a.length<t;)a.push(Object(P.jsx)(Ue.a,{}));return Object(P.jsx)(P.Fragment,{children:a})}var Ee={text:function(e){return e},scoreOutOf5:function(e){return Me(e,5)},scoreOutOf10:function(e){return Me(e,10)}};function Le(e){return Object(P.jsxs)(Se.a,{children:[Object(P.jsx)(ge.a,{children:e.name}),Object(P.jsx)(ge.a,{children:Ee[e.format](e.value)})]},e.uuid)}var Fe,De,Te=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.imageUrl?Object(P.jsx)("img",{src:this.props.imageUrl,style:{maxWidth:"2.5in"}}):void 0;return Object(P.jsxs)("div",{className:"label",children:[e,Object(P.jsx)(ve.a,{size:"small",children:Object(P.jsx)(xe.a,{children:this.props.data.attributes.map(Le)})})]})}}]),n}(r.a.Component),He=function(){var e=new URLSearchParams(window.location.search).get(le);if(e){var t=window.sessionStorage.getItem(e);if(t){var n=Object(E.b)(t,ce);return"success"===n.resultType?n.result:void console.error(n)}}}(),_e=null!==(Fe=function(){var e=window.localStorage.getItem(J);if(e){var t=Object(E.b)(e,D);return"success"===t.resultType?t.result:void console.error(t)}}())&&void 0!==Fe?Fe:{listIcon:"label"};i.a.render(Object(P.jsxs)(r.a.StrictMode,{children:[Object(P.jsx)("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"}),Object(P.jsx)("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/icon?family=Material+Icons"}),He?Object(P.jsx)(Te,{data:He,imageUrl:_e.imageDataUrl}):Object(P.jsx)(me,{defaultSettings:_e})]}),document.getElementById("root")),De&&De instanceof Function&&n.e(3).then(n.bind(null,189)).then((function(e){var t=e.getCLS,n=e.getFID,a=e.getFCP,r=e.getLCP,s=e.getTTFB;t(De),n(De),a(De),r(De),s(De)})).catch((function(e){console.error(e)}))},74:function(e,t){}},[[116,1,2]]]);
//# sourceMappingURL=main.ac7c005f.chunk.js.map